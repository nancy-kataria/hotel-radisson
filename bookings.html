<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- font -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css" integrity="sha256-46r060N2LrChLLb5zowXQ72/iKKNiw/lAmygmHExk/o="
        crossorigin="anonymous" />
    <!-- stylesheet -->
    <link rel="stylesheet" href="css/lightbox.min.css">
    <link rel="stylesheet" href="css/style1.css">
    <link rel="stylesheet" href="css/utilities.css">
    <link rel="stylesheet" href="css/modals.css">
    <title>Hotel RS | Bookings</title>
</head>

<body>

    <header>
        <div id="bookings" class="navbar">
            <h1 class="logo">
                <a href="index.html">HRS</a>
            </h1>

            <nav>
                <ul>
                    <li>
                        <a href="index.html">Home</a>
                    </li>
                    <li>
                        <a href="bookings.html">Bookings</a>
                    </li>
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="contact.html">Contact</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

     <!-- Rooms -->
     <section id="rooms" class="rooms flex-grid section-padding">
        <header class="section-header">
            <h2><span class="text-primary">Book</span> Your Rooms</h2>
        </header>
        <div class="row">
            <div class="column">
                <a href="img/bookings/living-room.jpg" data-lightbox="bookings" data-title="Living Room">
                    <img src="img/bookings/living-room.jpg" alt="">
                </a>
                
                <a href="img/bookings/restaurant.jpg" data-lightbox="bookings" data-title="Restaurant for your meals">
                    <img src="img/bookings/restaurant.jpg" alt="">
                </a>
            </div>
            <div class="column">
                <a href="img/bookings/lounge.jpg" data-lightbox="bookings" data-title="Our Luxury Lounge">
                    <img src="img/bookings/lounge.jpg" alt="">
                </a>

                <a href="img/bookings/single-room.jpg" data-lightbox="bookings" data-title="A single Room">
                    <img src="img/bookings/single-room.jpg" alt="">
                </a>
            </div>
            <div class="column">
                <a href="img/bookings/bed.jpg" data-lightbox="bookings" data-title="cozy furniture">
                    <img src="img/bookings/bed.jpg" alt="">
                </a>

                <a href="img/bookings/gym.jpg" data-lightbox="bookings" data-title="Fitness Room">
                    <img src="img/bookings/gym.jpg" alt="">
                </a>
            </div>
            <div class="column">
                <a href="img/bookings/swim-pool.jpg" data-lightbox="bookings" data-title="Swimming Pools">
                    <img src="img/bookings/swim-pool.jpg" alt="">
                </a>

                <a href="img/bookings/bathroom.jpg" data-lightbox="bookings" data-title="To enjoy Bathing">
                    <img src="img/bookings/bathroom.jpg" alt="">
                </a>
            </div>
        </div>
    </section>

    <section class="choice-container">
            <h2>Hello There</h2>
            <form>
                <div class="form-wrap">
                    <div class="form-group">
                    <label for="guests">Guests</label>
                    <div class="main-box">
                        <div class="minus" onclick="changeTotalGuests('sub')"><h2>-</h2></div>
                        <div id="totalGuests" class="number"><h2></h2></div>
                        <div class="plus" onclick="changeTotalGuests('add')" ><h2>+</h2></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="check-in">Check-In</label>
                    <input type="date" name="check-in" id="check-in">
                </div>
                <div class="form-group">
                    <label for="check-out">Check-Out</label>
                    <input type="date" name="check-out" id="check-out">
                </div>

            </div>

            <div class="rooms-selection border">
                <div class="grid">
                    <a href="img/bookings/single-room.jpg" data-lightbox="bookings" data-title="Single room">
                    <img src="img/bookings/single-room.jpg" alt="">
                </a>
                </div>
                <div class="grid">
                    <h3>Single Room</h3>
                     <p>Enjoy the settings of a cozy room with one king bed and one Sofabed, a mini fridge,
                          floor to ceiling windows with garden views amid 26.25 meters of space. &nbsp;</p>
                </div>
                <div class="grid">
                    <h4>&#8377 3,000</h4>
                    <p>Avg/Night (INR)</p>
                    <button id="singleRoomSelectBtn" type="button" onclick="onRoomSelect('single')" class="btn btn-green">Select</button>
                    <div id="singleTotalRooms" class="main-box hiddenBtn total-rooms">
                        <div class="minus" onclick="changeTotalRooms('single','sub')"><h2>-</h2></div>
                        <div id="singleTotalGuests" class="number"><h2></h2></div>
                        <div class="plus" onclick="changeTotalRooms('single','add')" ><h2>+</h2></div>
                    </div>
                </div>

            </div>


            <div class="rooms-selection border">
                <div class="grid">
                    <a href="img/bookings/twin-rooms.jpg" data-lightbox="bookings" data-title="Twin Room">
                    <img src="img/bookings/twin-rooms.jpg" alt="">
                </a>
                </div>
                <div class="grid">
                    <h3>Twin Room</h3>
                     <p>A 26.28 square meter room with twin beds, one Sofabed, a mini fridge
                        and floor to ceiling windows with garden views.</p>
                </div>
                <div class="grid">
                    <h4>&#8377 4,500</h4>
                    <p>Avg/Night (INR)</p>
                    <button id="twinRoomSelectBtn" type="button" onclick="onRoomSelect('twin')" class="btn btn-green">Select</button>
                    <div id="twinTotalRooms" class="main-box hiddenBtn total-rooms">
                        <div class="minus" onclick="changeTotalRooms('twin','sub')"><h2>-</h2></div>
                        <div id="twinTotalGuests" class="number"><h2></h2></div>
                        <div class="plus" onclick="changeTotalRooms('twin','add')" ><h2>+</h2></div>
                    </div>
                </div>

            </div>
            
            <div class="rooms-selection border">
                <div class="grid">
                    <a href="img/bookings/triple-room.jpg" data-lightbox="bookings" data-title="Triple Room">
                    <img src="img/bookings/triple-room.jpg" alt="">
                </a>
                </div>
                <div class="grid">
                    <h3>Triple Room</h3>
                     <p>A perfect room for three friends. A 32.45 square meter room with three beds,
                          two Sofa chairs, a mini fridge and floor to ceiling windows with Pool views.</p>
                </div>
                <div class="grid">
                    <h4>&#8377 5,700</h4>
                    <p>Avg/Night (INR)</p>
                    <button id="tripleRoomSelectBtn" type="button" onclick="onRoomSelect('triple')" class="btn btn-green">Select</button>
                    <div id="tripleTotalRooms" class="main-box hiddenBtn total-rooms">
                        <div class="minus" onclick="changeTotalRooms('triple','sub')"><h2>-</h2></div>
                        <div id="tripleTotalGuests" class="number"><h2></h2></div>
                        <div class="plus" onclick="changeTotalRooms('triple','add')" ><h2>+</h2></div>
                    </div>
                </div>

            </div>

            <div class="rooms-selection border">
                <div class="grid">
                    <a href="img/bookings/king-room.jpg" data-lightbox="bookings" data-title="King room">
                    <img src="img/bookings/king-room.jpg" alt="">
                </a>
                </div>
                <div class="grid">
                    <h3>King Room</h3>
                     <p>A 48-square-meter King bedroom featuring scenic views of the
                          pool, one king bedroom, a separate living area, a spacious bathroom
                           and a complimentary snack.</p>
                </div>
                <div class="grid">
                    <h4>&#8377 7,000</h4>
                    <p>Avg/Night (INR)</p>
                    <button id="kingRoomSelectBtn" type="button" onclick="onRoomSelect('king')" class="btn btn-green">Select</button>
                    <div id="kingTotalRooms" class="main-box hiddenBtn total-rooms">
                        <div class="minus" onclick="changeTotalRooms('king','sub')"><h2>-</h2></div>
                        <div id="kingTotalGuests" class="number"><h2></h2></div>
                        <div class="plus" onclick="changeTotalRooms('king','add')" ><h2>+</h2></div>
                    </div>
                </div>

            </div>

            <div class="rooms-selection border">
                <div class="grid">
                    <a href="img/bookings/deluxe-king-room.jpg" data-lightbox="bookings" data-title="Deluxe King room">
                    <img src="img/bookings/deluxe-king-room.jpg" alt="">
                </a>
                </div>
                <div class="grid">
                    <h3>Deluxe King Room</h3>
                     <p>Unwind in this contemporary 65-square-meter suite featuring scenic views of the
                          pool, one king bedroom, a separate living and dining area, a spacious bathroom
                           and three complimentary beers per day.</p>
                </div>
                <div class="grid">
                    <h4>&#8377 9,000</h4>
                    <p>Avg/Night (INR)</p>
                    <button id="deluxeRoomSelectBtn" type="button" onclick="onRoomSelect('deluxe')" class="btn btn-green">Select</button>
                    <div id="deluxeTotalRooms" class="main-box hiddenBtn total-rooms">
                        <div class="minus" onclick="changeTotalRooms('deluxe','sub')"><h2>-</h2></div>
                        <div id="deluxeTotalGuests" class="number"><h2></h2></div>
                        <div class="plus" onclick="changeTotalRooms('deluxe','sub')" ><h2>+</h2></div>
                    </div>
                </div>

            </div>

            </form>

            <div class="apply-button">
                <button id="applyButton" type="button" class="btn btn-green"><i class="fas fa-chevron-right"></i>
                     Apply</button> 
                     
                      <!-- The Modal -->
            <div id="myModal" class="modal">
                <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">×</span>
            
                <!-- Modal content -->
                <div class="modal-content">
                    <h2>Get ready for your stay</h2>
                    <p>Please enter your details in here</p>

                    <form action="javascript:onRegister();">
                    <div class="flex-columns">
                        <div class="row">
                            <div class="column">
                                <h3>Name</h3>
                                <div class="group">
                                    <div class="form">
                                    <label for="first-name">First Name</label>
                                    <input required type="text" name="first-name" id="first-name">

                                    <label for="Last-Name">Last Name</label>
                                    <input required type="text" name="Last-Name" id="last-name">
                                    </div>
                                </div>

                                <h3>Address</h3>
                                <div class="group">
                                    <div class="form">
                                        <label for="country">Country</label>
                                        <input required type="text" name="country" id="country">

                                        <label for="state">State</label>
                                        <input required type="text" name="state" id="state">
                                    </div>
                                </div>
                            </div>
                            <div class="column">
                                <h3>Contact Information</h3>
                                <div class="group">
                                    <div class="form">
                                    <label for="email">E-mail</label>
                                    <input required type="email" name="email" id="email" size="30">

                                    <label for="phone-number">Phone-number</label>
                                    <input required type="number" class="phone-number" id="phone-number">
                                </div>
                                </div>

                                <div class="group address-2">
                                    <div class="form">
                                        <label for="address">Address</label>
                                        <textarea required name="address" id="address" cols="30" rows="2"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="register-btn">
                                <button type="submit" id="myBtn" class="btn btn-green"><i class="fas fa-chevron-right"></i> Register</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div id="thanksModal" class="modall">
        <!-- Modal content -->
            <div class="modal-content-register">
                <span id="closeBtn" class="closeRegister">&times;</span>
                <div class="modal-body-register">
                <h3>Thank you for registering</h3>
                </div>
            </div>
        </div>
    </section>

    <!-- JAVASCRIPT FOR CREATING MODEL FOR REGISTERATION FORM -->
    <script>
        // Get the modal
        var modal = document.getElementById("myModal");
        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("close")[0];
        
        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
          modal.style.display = "none";
        }
        
        // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
          if (event.target == modal) {
            modal.style.display = "none";
          }
        }
    </script>

    <script>
        
        // Get the modal
        var modal = document.getElementById("myModal");

        // Get the button that opens the modal
        var btn = document.getElementById("myBtn");

        // Get the <span> element that closes the modal
        var span = document.getElementsByClassName("closeRegister")[0];

        // When the user clicks the button, open the modal 
        btn.onclick = function() {
        modal.style.display = "block";
         }

        // When the user clicks on <span> (x), close the modal
        span.onclick = function() {
        modal.style.display = "none";
        }

       // When the user clicks anywhere outside of the modal, close it
        window.onclick = function(event) {
        if (event.target == modal) {
        modal.style.display = "none";
        }
        } 
    </script>

    <!-- FOOTER -->
    <footer class="footer bg-light">
        <div class="social">
            <a href="https://www.facebook.com" target="_blank">
                <i class="fab fa-facebook fa-2x"></i>
            </a>
            <a href="https://www.facebook.com"target="_blank">
                <i class="fab fa-twitter fa-2x"></i>
            </a>
            <a href="https://www.youtube.com" target="_blank">
                <i class="fab fa-youtube fa-2x"></i>
            </a>
            <a href="https://www.linkedin.com/login"target="_blank">
                <i class="fab fa-linkedin fa-2x"></i>
            </a>
            <h4>Hotel Raddison &copy; 2020, All Rights Reserved</h4>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
 
    <script src="js/lightbox.min.js"></script>
    <script>
        let totalGuests = 1;
        let totalSingleRooms = 0;
        let totalTwinRooms = 0;
        let totalTripleRooms = 0;
        let totalKingRooms = 0;
        let totalDeluxeRooms = 0;

        const guestsElement =  document.getElementById("totalGuests");
        guestsElement.innerText = totalGuests;

        var modal = document.getElementById("myModal");
        var btn = document.getElementById("applyButton");
        btn.onclick = function() {
            if(totalSingleRooms + totalTwinRooms + totalTripleRooms + totalKingRooms + totalDeluxeRooms === 0){
                alert("Please select at least one room.");
                return false;
            }
            modal.style.display = "block";
        }


        function changeTotalGuests(type){
            if(type==='add'){
                if(totalGuests <= 9){
                    totalGuests++;
                }
            }else if(totalGuests > 1){
                totalGuests--;
            }
            guestsElement.innerText = totalGuests;
        }

        function onRoomSelect(roomType){
            const selectRoomButton = document.getElementById(`${roomType}RoomSelectBtn`);
            selectRoomButton.classList.add('hiddenBtn');
            const roomSelector = document.getElementById(`${roomType}TotalRooms`);
            roomSelector.classList.remove('hiddenBtn');
            const totalRooms = document.getElementById(`${roomType}TotalGuests`);

            switch(roomType){
                case 'single':
                    totalSingleRooms = 1;
                    totalRooms.innerText = totalSingleRooms;
                    break;
                case 'twin':
                    totalTwinRooms = 1;
                    totalRooms.innerText = totalTwinRooms;
                    break;
                case 'triple':
                    totalTripleRooms = 1;
                    totalRooms.innerText = totalTripleRooms;
                    break;
                case 'king':
                    totalKingRooms = 1;
                    totalRooms.innerText = totalKingRooms;
                    break;
                case 'deluxe':
                    totalDeluxeRooms = 1;
                    totalRooms.innerText = totalDeluxeRooms;
                    break;
            }
        }

        function changeTotalRooms(roomType, operation){
            const totalGuests = document.getElementById(`${roomType}TotalGuests`);
            switch(roomType){
                case 'single':
                    if(operation==='add'){
                        if(totalSingleRooms<=4){
                            totalSingleRooms++;
                        }
                    }else{
                        if(totalSingleRooms === 1){
                            showSelectRoomButton(roomType);
                            totalSingleRooms--;
                        }else{
                            totalSingleRooms--;
                        }
                    }
                    totalGuests.innerText = totalSingleRooms;
                    break;
                case 'twin':
                    if(operation==='add'){
                        if(totalTwinRooms<=4){
                            totalTwinRooms++;
                        }
                    }else{
                        if(totalTwinRooms === 1){
                            showSelectRoomButton(roomType);
                            totalTwinRooms--;
                        }else{
                            totalTwinRooms--;
                        }
                    }
                    totalGuests.innerText = totalTwinRooms;
                    break;
                case 'triple':
                    if(operation==='add'){
                        if(totalTripleRooms<=4){
                            totalTripleRooms++;
                        }
                    }else{
                        if(totalTripleRooms === 1){
                            showSelectRoomButton(roomType);
                            totalTripleRooms--;
                        }else{
                            totalTripleRooms--;
                        }
                    }
                    totalGuests.innerText = totalTripleRooms;
                    break;
                case 'king':
                    if(operation==='add'){
                        if(totalKingRooms<=4){
                            totalKingRooms++;
                        }
                    }else{
                        if(totalKingRooms === 1){
                            showSelectRoomButton(roomType);
                            totalKingRooms--;
                        }else{
                            totalKingRooms--;
                        }
                    }
                    totalGuests.innerText = totalKingRooms;
                    break;
                case 'deluxe':
                    if(operation==='add'){
                        if(totalDeluxeRooms<=4){
                            totalDeluxeRooms++;
                        }
                    }else{
                        if(totalDeluxeRooms === 1){
                            showSelectRoomButton(roomType);
                            totalDeluxeRooms--;
                        }else{
                            totalDeluxeRooms--;
                        }
                    }
                    totalGuests.innerText = totalDeluxeRooms;
                    break;
            }
        }

        function showSelectRoomButton(roomType){
            const selectRoomButton = document.getElementById(`${roomType}RoomSelectBtn`);
            selectRoomButton.classList.remove('hiddenBtn');
            const roomSelector = document.getElementById(`${roomType}TotalRooms`);
            roomSelector.classList.add('hiddenBtn');
        }

        async function onRegister(){
            const inputs = ['first-name', 'last-name', 'country', 'phone-number', 'state', 'email', 'address', 'check-in', 'check-out'];
            const payload = {};

            inputs.forEach(input=>{
                payload[input.replace('-','_')] = document.getElementById(input).value;
            });
            
            if(totalSingleRooms){
                payload.totalSingleRooms = totalSingleRooms;
            }
            if(totalTwinRooms){
                payload.totalTwinRooms = totalTwinRooms;
            }
            if(totalTripleRooms){
                payload.totalTripleRooms = totalTripleRooms;
            }
            if(totalKingRooms){
                payload.totalKingRooms = totalKingRooms;
            }
            if(totalDeluxeRooms){
                payload.totalDeluxeRooms = totalDeluxeRooms;
            }
            try {
                const resposne = await fetch('http://localhost:3000/booking',
                {
                    body: JSON.stringify(payload), 
                    method:"POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                });
                const data = await resposne.json();
                document.getElementById('myModal').style.display = 'none';
                const thanksModal = document.getElementById('thanksModal');
                thanksModal.style.display = "block";
                totalGuests = 1;
                totalSingleRooms = 0;
                totalTwinRooms = 0;
                totalTripleRooms = 0;
                totalKingRooms = 0;
                totalDeluxeRooms = 0;
                document.getElementById('check-in').value = null;
                document.getElementById('check-out').value = null;
            } catch (error) {
                alert(error.error || 'Something went wrong. Please try again.' );
            }
            return false;
        }

        
    </script>
    
</body>

</html>
